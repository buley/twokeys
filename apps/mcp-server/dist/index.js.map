{"version":3,"sources":["../src/index.ts"],"sourcesContent":["#!/usr/bin/env node\n/**\n * Twokeys MCP Server\n *\n * Exposes all Twokeys statistical functions as MCP tools for use with\n * LLMs and AI assistants.\n */\n\nimport { createMCPServer } from '@affectively/mcp-framework';\nimport { Series } from 'twokeys';\n\n// =============================================================================\n// Tool Handlers\n// =============================================================================\n\nconst handlers = {\n  async analyze(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return series.describe();\n  },\n\n  async median(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return series.median();\n  },\n\n  async mean(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return { mean: series.mean() };\n  },\n\n  async mode(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return series.mode();\n  },\n\n  async outliers(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return {\n      outliers: series.outliers(),\n      fences: series.fences(),\n    };\n  },\n\n  async fences(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return {\n      innerFences: series.fences(),\n      outerFences: series.outer(),\n    };\n  },\n\n  async hinges(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return {\n      hinges: series.hinges(),\n      iqr: series.iqr(),\n    };\n  },\n\n  async five_number_summary(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    const extremes = series.extremes();\n    const hinges = series.hinges();\n    const median = series.median();\n    return {\n      minimum: extremes[0],\n      q1: hinges[0]?.datum,\n      median: median.datum,\n      q3: hinges[1]?.datum,\n      maximum: extremes[1],\n    };\n  },\n\n  async trimean(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return {\n      trimean: series.trimean(),\n      median: series.median().datum,\n      mean: series.mean(),\n    };\n  },\n\n  async letter_values(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return series.letterValues();\n  },\n\n  async stem_leaf(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return series.stemLeaf();\n  },\n\n  async ranked(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return series.ranked();\n  },\n\n  async binned(args: { data: number[]; bins?: number }) {\n    const series = new Series({ data: args.data });\n    return series.binned(args.bins);\n  },\n\n  async smooth(args: { data: number[] }) {\n    const series = new Series({ data: args.data });\n    return {\n      original: args.data,\n      smooth: series.smooth(),\n      rough: series.rough(),\n      hanning: series.hanning(),\n    };\n  },\n\n  async transform(args: { data: number[]; type: 'log' | 'sqrt' | 'inverse' }) {\n    const series = new Series({ data: args.data });\n    let result: number[];\n    switch (args.type) {\n      case 'log':\n        result = series.logs();\n        break;\n      case 'sqrt':\n        result = series.roots();\n        break;\n      case 'inverse':\n        result = series.inverse();\n        break;\n    }\n    return {\n      original: args.data,\n      transformed: result,\n      type: args.type,\n    };\n  },\n};\n\n// =============================================================================\n// Tool Definitions\n// =============================================================================\n\nconst tools = [\n  {\n    name: 'analyze',\n    description: 'Perform complete exploratory data analysis on a dataset.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers to analyze',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'median',\n    description: 'Calculate the median (middle value) and its depth.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'mean',\n    description: 'Calculate the arithmetic mean (average).',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'mode',\n    description: 'Find the mode(s) - most frequently occurring value(s).',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'outliers',\n    description: 'Detect outliers using Tukey fences (1.5 × IQR).',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'fences',\n    description: 'Calculate Tukey fences for outlier detection.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'hinges',\n    description: 'Calculate hinges (quartiles Q1 and Q3) with IQR.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'five_number_summary',\n    description: 'Calculate min, Q1, median, Q3, max for box plots.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'trimean',\n    description: \"Tukey's trimean: (Q1 + 2×median + Q3) / 4.\",\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'letter_values',\n    description: 'Extended quartiles: M, F, E, D, C, B, A...',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'stem_leaf',\n    description: 'Stem-and-leaf text display.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'ranked',\n    description: 'Rank information with tie handling.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'binned',\n    description: 'Histogram-style binning.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n        bins: {\n          type: 'number' as const,\n          description: 'Number of bins (optional)',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'smooth',\n    description: \"Tukey's 3RSSH smoothing with residuals.\",\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers (minimum 3)',\n        },\n      },\n      required: ['data'],\n    },\n  },\n  {\n    name: 'transform',\n    description: 'Apply log, sqrt, or inverse transform.',\n    inputSchema: {\n      type: 'object' as const,\n      properties: {\n        data: {\n          type: 'array' as const,\n          items: { type: 'number' as const },\n          description: 'Array of numbers',\n        },\n        type: {\n          type: 'string' as const,\n          enum: ['log', 'sqrt', 'inverse'],\n          description: 'Transform type',\n        },\n      },\n      required: ['data', 'type'],\n    },\n  },\n];\n\n// =============================================================================\n// Server Setup\n// =============================================================================\n\nconst server = createMCPServer({\n  name: 'twokeys',\n  version: '2.0.0',\n  description: 'Exploratory Data Analysis tools inspired by John Tukey.',\n  tools,\n  handlers,\n});\n\nserver.start();\n"],"mappings":"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","names":[]}