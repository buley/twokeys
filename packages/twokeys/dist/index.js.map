{"version":3,"sources":["../src/index.ts"],"names":["randomInteger","max","randomSeries","count","series","i","randomPoint","dimension","point","randomPoints","points","Series","options","arr","a","b","offset","len","mid","total","num","data","freq","maxCount","val","modes","result","hinges","copy","hingeCount","per","howMany","step","fragment","first","second","multiple","base","iqr","extra","results","sorted","outer","min","fences","ties","up","down","ranked","tiedRank","tiedNumbers","reset","incr","decr","item","usable","low","lows","high","highs","bins","width","includeZero","binned","zeroOffset","extremes","calculatedWidth","areIntegers","binCount","bin","original","smoothed","residuals","x","passes","current","end","pass","changed","third","tmp","median","antepenultimate","penultimate","last","t1","t2","f1","left","right","next","floor","multiplier","weight","nextCurrent","jittered","w","value","med","h","n","letters","medDepth","medValue","depth","letterIdx","lowerIdx","upperIdx","lower","upper","spread","leafDigits","scale","stems","stem","leaf","sortedStems","stemStrings","leavesRecord","display","stemStr","leaves","Points","Twokeys","index_default"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Twokeys - A small data exploration and manipulation library\n * Named after John Tukey, pioneer of exploratory data analysis (EDA)\n *\n * Features:\n * - Summary statistics (mean, median, mode, quartiles)\n * - Binning (histogram-like grouping)\n * - Smoothing (Hanning filter and median smoothing)\n * - Ranking and ranking analysis\n * - Outlier detection (using Tukey fences)\n * - Data transforms (logarithms, roots, inverses)\n */\n\nexport interface SeriesOptions {\n  data?: number[];\n}\n\nexport interface PointsOptions {\n  data?: number[][];\n  dimensionality?: number;\n  count?: number;\n}\n\nexport interface MedianResult {\n  datum: number;\n  depth: number;\n}\n\nexport interface ModeResult {\n  count: number;\n  data: number[];\n}\n\nexport interface RankInfo {\n  rank: number;\n  peers: number;\n}\n\nexport interface RankedResult {\n  up: Record<number, RankInfo>;\n  down: Record<number, RankInfo>;\n  groups: {\n    up: (number | number[])[];\n    down: (number | number[])[];\n  };\n}\n\nexport interface BinnedResult {\n  bins: number;\n  width: number;\n  binned: Record<\n    number,\n    {\n      from: number;\n      to: number;\n      data: number[];\n    }\n  >;\n}\n\nexport interface SeriesDescription {\n  original: number[];\n  summary: {\n    median: MedianResult;\n    mean: number;\n    mode: ModeResult;\n    hinges: MedianResult[];\n    adjacent: number[];\n    outliers: number[];\n    outer: number[];\n    outside: number[];\n    inside: number[];\n    extremes: number[];\n    iqr: number;\n    fences: number[];\n  };\n  smooths: {\n    smooth: number[];\n    hanning: number[];\n  };\n  transforms: {\n    logs: number[];\n    roots: number[];\n    inverse: number[];\n  };\n  counts: [number, number][];\n  sorted: number[];\n  ranked: RankedResult;\n  binned: BinnedResult;\n}\n\nexport interface PointsDescription {\n  original: number[][];\n}\n\n// Constants\nconst DEFAULT_MAX_RANDOM_INTEGER = 100;\nconst DEFAULT_MIN_RANDOM_INTEGER = 0;\nconst DEFAULT_RANDOM_SERIES_COUNT = 1000;\nconst DEFAULT_OUTLIER_MULTIPLE = 1.5;\nconst DEFAULT_JITTER_MULTIPLIER = 1;\nconst DEFAULT_SPLIT_PASSES = 2;\nconst DEFAULT_MAX_RANDOM_DIMENSIONALITY = 2;\n\n// Utility functions\nfunction randomInteger(max: number = DEFAULT_MAX_RANDOM_INTEGER): number {\n  return Math.floor(Math.random() * max);\n}\n\nfunction randomSeries(\n  count: number = DEFAULT_RANDOM_SERIES_COUNT,\n  max: number = DEFAULT_MAX_RANDOM_INTEGER\n): number[] {\n  const series: number[] = [];\n  for (let i = 0; i < count; i++) {\n    series.push(randomInteger(max));\n  }\n  return series;\n}\n\nfunction randomPoint(\n  dimension: number = DEFAULT_MAX_RANDOM_DIMENSIONALITY,\n  max: number = DEFAULT_MAX_RANDOM_INTEGER\n): number[] {\n  const point: number[] = [];\n  for (let i = 0; i < dimension; i++) {\n    point.push(Math.floor((Math.random() * (max / 10)) % max));\n  }\n  return point;\n}\n\nfunction randomPoints(\n  count: number = DEFAULT_RANDOM_SERIES_COUNT,\n  dimension: number = DEFAULT_MAX_RANDOM_DIMENSIONALITY,\n  max: number = DEFAULT_MAX_RANDOM_INTEGER\n): number[][] {\n  const points: number[][] = [];\n  for (let i = 0; i < count; i++) {\n    points.push(randomPoint(dimension, max));\n  }\n  return points;\n}\n\n/**\n * Series class for 1D data exploration\n */\nexport class Series {\n  private data: {\n    original: number[];\n    sorted?: number[];\n    median?: number;\n    medianDepth?: number;\n    mean?: number;\n    mode?: ModeResult;\n    extremes?: number[];\n    counts?: [number, number][];\n    hinges?: MedianResult[];\n    iqr?: number;\n    fences?: number[];\n    outer?: number[];\n    outside?: number[];\n    inside?: number[];\n    outliers?: number[];\n    ranked?: RankedResult;\n    adjacent?: number[];\n    binned?: BinnedResult;\n    logs?: number[];\n    roots?: number[];\n    inverse?: number[];\n    hanning?: number[];\n    smooth?: number[];\n    rough?: number[];\n    description?: SeriesDescription;\n  };\n\n  constructor(options: SeriesOptions = {}) {\n    this.data = {\n      original: options.data ?? randomSeries(),\n    };\n  }\n\n  // Sort\n  sorted(): number[] {\n    if (!this.data.sorted) {\n      this.data.sorted = this.getSorted(this.data.original);\n    }\n    return this.data.sorted;\n  }\n\n  private getSorted(arr: number[]): number[] {\n    return [...arr].sort((a, b) => {\n      if (a > b) return 1;\n      if (a === b) return 0;\n      return -1;\n    });\n  }\n\n  // Median\n  median(): MedianResult {\n    this.sorted();\n    if (this.data.median === undefined) {\n      this.data.median = this.getMedian(this.data.sorted!);\n    }\n    if (this.data.medianDepth === undefined) {\n      this.data.medianDepth = this.getMedianDepth(this.data.sorted!);\n    }\n    return {\n      datum: this.data.median,\n      depth: this.data.medianDepth,\n    };\n  }\n\n  private getMedianDepth(arr: number[], offset: number = 0): number {\n    if (!arr.length) return NaN;\n    return offset + (arr.length + 1) / 2;\n  }\n\n  private getMedian(arr: number[]): number {\n    const len = arr.length;\n    if (!len) return NaN;\n    if (len === 1) return arr[0];\n\n    const mid = Math.floor(len / 2);\n    if (len % 2 === 0) {\n      return (arr[mid - 1] + arr[mid]) / 2;\n    }\n    return arr[mid];\n  }\n\n  // Mean\n  mean(): number {\n    if (this.data.mean === undefined) {\n      this.data.mean = this.getMean(this.data.original);\n    }\n    return this.data.mean;\n  }\n\n  private getMean(arr: number[]): number {\n    if (!arr.length) return NaN;\n    let total = 0;\n    for (const num of arr) {\n      total += num;\n    }\n    return total / arr.length;\n  }\n\n  // Mode\n  mode(): ModeResult {\n    if (!this.data.mode) {\n      this.sorted();\n      this.data.mode = this.getMode(this.data.sorted!);\n    }\n    return this.data.mode;\n  }\n\n  private getMode(data: number[]): ModeResult {\n    if (!data.length) {\n      return { count: 0, data: [] };\n    }\n\n    // Count frequencies\n    const freq: Record<number, number> = {};\n    let maxCount = 0;\n\n    for (const val of data) {\n      freq[val] = (freq[val] || 0) + 1;\n      if (freq[val] > maxCount) {\n        maxCount = freq[val];\n      }\n    }\n\n    // Find all values with max frequency\n    const modes: number[] = [];\n    for (const [val, count] of Object.entries(freq)) {\n      if (count === maxCount) {\n        modes.push(Number(val));\n      }\n    }\n\n    return {\n      count: maxCount,\n      data: modes.sort((a, b) => a - b),\n    };\n  }\n\n  // Extremes\n  extremes(): number[] {\n    if (!this.data.extremes) {\n      this.sorted();\n      this.data.extremes = this.getExtremes(this.data.sorted!);\n    }\n    return this.data.extremes;\n  }\n\n  private getExtremes(data: number[]): number[] {\n    if (!data.length) return [];\n    return [data[0], data[data.length - 1]];\n  }\n\n  // Counts\n  counts(): [number, number][] {\n    if (!this.data.counts) {\n      this.sorted();\n      this.data.counts = this.getCounts(this.data.sorted!);\n    }\n    return this.data.counts;\n  }\n\n  private getCounts(data: number[]): [number, number][] {\n    const freq = new Map<number, number>();\n    for (const val of data) {\n      freq.set(val, (freq.get(val) || 0) + 1);\n    }\n    const result: [number, number][] = [];\n    for (const [val, count] of freq) {\n      result.push([val, count]);\n    }\n    return result.sort((a, b) => a[0] - b[0]);\n  }\n\n  // Hinges (quartiles)\n  hinges(): MedianResult[] {\n    if (!this.data.hinges) {\n      this.sorted();\n      this.data.hinges = this.getHinges(this.data.sorted!);\n    }\n    return this.data.hinges;\n  }\n\n  private getHinges(\n    arr: number[],\n    hinges: number = 2,\n    result: MedianResult[] = []\n  ): MedianResult[] {\n    const copy = [...arr];\n    const total = copy.length;\n\n    let hingeCount = hinges;\n    if (hingeCount % 2 !== 0) {\n      hingeCount++;\n    }\n\n    if (total <= hingeCount || hingeCount <= 0) {\n      return result;\n    }\n\n    const per = Math.floor(total / hingeCount);\n    const howMany = Math.floor(total / per) - 1;\n\n    for (let step = 0; step <= howMany; step++) {\n      const fragment = copy.slice(step * per, step * per + per);\n      result.push({\n        datum: this.getMedian(fragment),\n        depth: this.getMedianDepth(fragment, step * per),\n      });\n    }\n\n    return result;\n  }\n\n  // IQR (Interquartile Range)\n  iqr(): number {\n    if (this.data.iqr === undefined) {\n      this.hinges();\n      this.data.iqr = this.getIQR(this.data.hinges!);\n    }\n    return this.data.iqr;\n  }\n\n  private getIQR(hinges: MedianResult[]): number {\n    const first = hinges[0]?.datum;\n    const second = hinges[1]?.datum;\n    if (first === undefined || second === undefined) {\n      return NaN;\n    }\n    return Math.abs(first - second);\n  }\n\n  // Fences\n  fences(): number[] {\n    if (!this.data.fences) {\n      this.median();\n      this.iqr();\n      this.data.fences = this.getFences();\n    }\n    return this.data.fences;\n  }\n\n  private getFences(multiple: number = DEFAULT_OUTLIER_MULTIPLE): number[] {\n    const base = this.data.median;\n    const iqr = this.data.iqr;\n    if (base === undefined || iqr === undefined || isNaN(iqr)) {\n      return [];\n    }\n    const extra = iqr * multiple;\n    return [base - extra, base + extra];\n  }\n\n  // Outer fences\n  outer(): number[] {\n    if (!this.data.outer) {\n      this.median();\n      this.iqr();\n      this.data.outer = this.getOuter();\n    }\n    return this.data.outer;\n  }\n\n  private getOuter(multiple: number = DEFAULT_OUTLIER_MULTIPLE): number[] {\n    const base = this.data.median;\n    const iqr = this.data.iqr;\n    if (base === undefined || iqr === undefined || isNaN(iqr)) {\n      return [];\n    }\n    const extra = 2 * iqr * multiple;\n    return [base - extra, base + extra];\n  }\n\n  // Outside values\n  outside(): number[] {\n    if (!this.data.outside) {\n      this.outer();\n      this.data.outside = this.getOutside();\n    }\n    return this.data.outside;\n  }\n\n  private getOutside(): number[] {\n    const results: number[] = [];\n    const sorted = this.data.sorted!;\n    const outer = this.data.outer;\n    if (!outer || outer.length === 0) return [];\n    const min = Math.min(...outer);\n    const max = Math.max(...outer);\n    for (const num of sorted) {\n      if (num > max || num < min) {\n        results.push(num);\n      }\n    }\n    return results;\n  }\n\n  // Inside values\n  inside(): number[] {\n    if (!this.data.inside) {\n      this.fences();\n      this.data.inside = this.getInside();\n    }\n    return this.data.inside;\n  }\n\n  private getInside(): number[] {\n    const results: number[] = [];\n    const sorted = this.data.sorted!;\n    const fences = this.data.fences;\n    if (!fences || fences.length === 0) return [];\n    const min = Math.min(...fences);\n    const max = Math.max(...fences);\n    for (const num of sorted) {\n      if (num < max && num > min) {\n        results.push(num);\n      }\n    }\n    return results;\n  }\n\n  // Outliers\n  outliers(): number[] {\n    if (!this.data.outliers) {\n      this.fences();\n      this.data.outliers = this.getOutliers();\n    }\n    return this.data.outliers;\n  }\n\n  private getOutliers(): number[] {\n    const results: number[] = [];\n    const sorted = this.data.sorted!;\n    const fences = this.data.fences!;\n    if (fences.length === 0) return [];\n    const min = Math.min(...fences);\n    const max = Math.max(...fences);\n    for (const num of sorted) {\n      if (num > max || num < min) {\n        results.push(num);\n      }\n    }\n    return results;\n  }\n\n  // Ranked\n  ranked(): RankedResult {\n    if (!this.data.ranked) {\n      this.sorted();\n      this.data.ranked = this.getRanked(this.data.sorted!);\n    }\n    return this.data.ranked;\n  }\n\n  private getRanked(arr: number[], ties: boolean = true): RankedResult {\n    const up: Record<number, RankInfo> = {};\n    const down: Record<number, RankInfo> = {};\n    const total = arr.length;\n    const ranked: (number | number[])[] = [];\n\n    let tiedRank = NaN;\n    let tiedNumbers: number[] = [];\n\n    const reset = () => {\n      tiedRank = NaN;\n      tiedNumbers = [];\n    };\n\n    for (let i = 0; i < arr.length; i++) {\n      const num = arr[i];\n\n      if (!ties) {\n        up[num] = { rank: i + 1, peers: 0 };\n        down[num] = { rank: total - i, peers: 0 };\n      } else {\n        const incr = i + 1;\n        const decr = i - 1;\n\n        if (num === arr[decr]) {\n          if (!isNaN(tiedRank) && tiedNumbers.length === 0) {\n            tiedNumbers.push(num);\n            ranked.push(tiedNumbers);\n            reset();\n          } else {\n            tiedNumbers.push(num);\n            tiedRank = decr;\n          }\n          if (num !== arr[incr]) {\n            ranked.push(tiedNumbers);\n            reset();\n          }\n        } else {\n          if (num !== arr[incr]) {\n            if (tiedNumbers.length > 0) {\n              ranked.push(tiedNumbers);\n              reset();\n            } else {\n              ranked.push(num);\n            }\n          } else {\n            tiedNumbers.push(num);\n          }\n        }\n      }\n    }\n\n    let offset = 0;\n    for (let i = 0; i < ranked.length; i++) {\n      const item = ranked[i];\n      if (typeof item === 'number') {\n        down[item] = { rank: i + 1 + offset, peers: 0 };\n        up[item] = { rank: total - i - offset, peers: 0 };\n      } else if (Array.isArray(item)) {\n        offset += item.length;\n        const usable = item[0];\n        down[usable] = { rank: i + 1 + offset, peers: item.length };\n        up[usable] = { rank: total - i - offset, peers: item.length };\n      } else {\n        offset += 1;\n      }\n    }\n\n    return {\n      up,\n      down,\n      groups: {\n        down: [...ranked],\n        up: [...ranked].reverse(),\n      },\n    };\n  }\n\n  // Adjacent\n  adjacent(): number[] {\n    if (!this.data.adjacent) {\n      this.fences();\n      this.data.adjacent = this.getAdjacent(this.data.sorted!, this.data.fences!);\n    }\n    return this.data.adjacent;\n  }\n\n  private getAdjacent(arr: number[], fences: number[]): number[] {\n    if (fences.length === 0) return [];\n\n    const low = fences[0];\n    const lows: number[] = [];\n    const high = fences[1];\n    const highs: number[] = [];\n\n    for (const val of arr) {\n      if (val > low) lows.push(val);\n      if (val < high) highs.push(val);\n    }\n\n    lows.sort((a, b) => a - b);\n    highs.sort((a, b) => a - b);\n\n    return [lows[0], highs[highs.length - 1]];\n  }\n\n  // Binned\n  binned(bins: number = NaN): BinnedResult {\n    if (!this.data.binned) {\n      this.sorted();\n      this.extremes();\n      this.data.binned = this.getBinned(this.data.sorted!, bins);\n    }\n    return this.data.binned;\n  }\n\n  private getBinned(\n    arr: number[],\n    bins: number = 10,\n    width: number = NaN,\n    includeZero: boolean = true\n  ): BinnedResult {\n    const binned: Record<number, { from: number; to: number; data: number[] }> = {};\n    const total = arr.length;\n    const zeroOffset = includeZero ? 0 : 1;\n\n    if (total === 0) {\n      return { bins: 0, width: NaN, binned: {} };\n    }\n\n    const extremes = this.data.extremes!;\n    let calculatedWidth = width;\n\n    if (extremes && isNaN(calculatedWidth) && extremes.length === 2) {\n      calculatedWidth = (extremes[1] - extremes[0]) / (Math.log(arr.length) / Math.LN2);\n      calculatedWidth = Math.floor(calculatedWidth);\n\n      let areIntegers = true;\n      for (const item of arr) {\n        if (item % 1 !== 0) {\n          areIntegers = false;\n          break;\n        }\n      }\n      if (areIntegers) {\n        calculatedWidth = Math.floor(calculatedWidth);\n      }\n    }\n\n    let binCount = Math.floor(extremes[1] / calculatedWidth) + 1;\n    if (!binCount || binCount < 1) {\n      binCount = 1;\n    }\n\n    for (const val of arr) {\n      const bin = Math.floor((val - zeroOffset) / calculatedWidth);\n      if (!binned[bin]) {\n        binned[bin] = {\n          from: bin * calculatedWidth + zeroOffset,\n          to: (bin + 1) * calculatedWidth + zeroOffset - 1,\n          data: [],\n        };\n      }\n      binned[bin].data.push(val);\n    }\n\n    return {\n      bins: binCount,\n      width: calculatedWidth,\n      binned,\n    };\n  }\n\n  // Transforms\n  logs(): number[] {\n    if (!this.data.logs) {\n      this.data.logs = this.getLogs(this.data.original);\n    }\n    return this.data.logs;\n  }\n\n  private getLogs(arr: number[]): number[] {\n    return arr.map((val) => Math.log(val));\n  }\n\n  roots(): number[] {\n    if (!this.data.roots) {\n      this.data.roots = this.getRoots(this.data.original);\n    }\n    return this.data.roots;\n  }\n\n  private getRoots(arr: number[]): number[] {\n    return arr.map((val) => Math.sqrt(val));\n  }\n\n  inverse(): number[] {\n    if (!this.data.inverse) {\n      this.data.inverse = this.getInverse(this.data.original);\n    }\n    return this.data.inverse;\n  }\n\n  private getInverse(arr: number[]): number[] {\n    return arr.map((val) => 1 / val);\n  }\n\n  // Smoothing\n  hanning(): number[] {\n    if (!this.data.hanning) {\n      this.data.hanning = this.getSkipMeans(this.data.original);\n    }\n    return this.data.hanning;\n  }\n\n  private getSkipMeans(arr: number[]): number[] {\n    const results: number[] = [];\n    for (let i = 0; i < arr.length; i++) {\n      if (i !== 0 && i !== arr.length - 1) {\n        results.push((arr[i] + arr[i + 1]) / 2);\n      }\n    }\n    results.unshift(arr[0]);\n    results.push(arr[arr.length - 1]);\n    return results;\n  }\n\n  smooth(): number[] {\n    if (!this.data.smooth) {\n      this.sorted();\n      this.data.smooth = this.getSmooth(this.data.original);\n    }\n    this.data.rough = this.getRough(this.data.original, this.data.smooth);\n    return this.data.smooth;\n  }\n\n  private getRough(original: number[], smoothed: number[]): number[] {\n    const residuals: number[] = [];\n    for (let x = 0; x < original.length; x++) {\n      residuals.push(original[x] - smoothed[x]);\n    }\n    return residuals;\n  }\n\n  private getSmooth(arr: number[], passes: number = 3): number[] {\n    let smoothed = [...arr];\n    smoothed = this.smoothMedian(smoothed, passes);\n    smoothed = this.smoothExtremes(smoothed, -1);\n    smoothed = this.smoothSplit(smoothed, 2);\n    smoothed = this.smoothMedian(smoothed, passes);\n    smoothed = this.smoothExtremes(smoothed, -1);\n    smoothed = this.smoothMedian(smoothed, passes);\n    return smoothed;\n  }\n\n  private smoothExtremes(\n    arr: number[],\n    passes: number = 1,\n    current: number = 0,\n    end: 'both' | 'head' | 'tail' = 'both'\n  ): number[] {\n    const len = arr.length;\n    if (len <= 2) return [...arr];\n\n    const result = [...arr];\n\n    for (let pass = current; pass < passes || passes === -1; pass++) {\n      let changed = false;\n\n      if (end === 'both' || end === 'head') {\n        const first = result[0];\n        const second = result[1];\n        const third = result[2];\n        const tmp = second - 2 * (third - second);\n        // Median of three: sort and pick middle\n        const median =\n          first <= second\n            ? second <= tmp\n              ? second\n              : first <= tmp\n                ? tmp\n                : first\n            : first <= tmp\n              ? first\n              : second <= tmp\n                ? tmp\n                : second;\n        if (result[0] !== median) {\n          result[0] = median;\n          changed = true;\n        }\n      }\n\n      if (end === 'both' || end === 'tail') {\n        const antepenultimate = result[len - 3];\n        const penultimate = result[len - 2];\n        const last = result[len - 1];\n        const tmp = penultimate - 2 * (antepenultimate - penultimate);\n        const median =\n          last <= penultimate\n            ? penultimate <= tmp\n              ? penultimate\n              : last <= tmp\n                ? tmp\n                : last\n            : last <= tmp\n              ? last\n              : penultimate <= tmp\n                ? tmp\n                : penultimate;\n        if (result[len - 1] !== median) {\n          result[len - 1] = median;\n          changed = true;\n        }\n      }\n\n      if (passes === -1 && !changed) {\n        break;\n      }\n    }\n    return result;\n  }\n\n  private smoothSplit(\n    arr: number[],\n    passes: number = DEFAULT_SPLIT_PASSES,\n    current: number = 0\n  ): number[] {\n    let result = [...arr];\n    const len = arr.length;\n\n    for (let pass = current; pass < passes || passes === -1; pass++) {\n      let changed = false;\n\n      for (let i = 2; i < len - 1; i++) {\n        const num = result[i];\n        const t1 = result[i - 1];\n        const t2 = result[i - 2];\n        const f1 = result[i + 1];\n\n        if (num === t1 && ((t1 > t2 && num > f1) || (t1 < t2 && num < f1))) {\n          // Apply smoothExtremes at split point in-place\n          const left = this.smoothExtremes(result.slice(0, i));\n          const right = this.smoothExtremes(result.slice(i));\n          result = left.concat(right);\n          changed = true;\n        }\n      }\n\n      if (passes === -1 && !changed) {\n        return result;\n      }\n    }\n    return result;\n  }\n\n  private smoothMedian(arr: number[], passes: number = 1, current: number = 0): number[] {\n    let result = arr;\n    const len = arr.length;\n    if (len <= 2) return [...arr];\n\n    for (let pass = current; pass < passes || passes === -1; pass++) {\n      const next = new Array<number>(len);\n      next[0] = result[0];\n      next[len - 1] = result[len - 1];\n\n      let changed = false;\n      for (let i = 1; i < len - 1; i++) {\n        const val = result[i];\n        const smoothed = Math.min(Math.max(result[i - 1], val), result[i + 1]);\n        next[i] = smoothed;\n        if (smoothed !== val) changed = true;\n      }\n\n      if (passes === -1 && !changed) {\n        return result;\n      }\n      result = next;\n    }\n    return result;\n  }\n\n  private jitter(\n    arr: number[],\n    passes: number = 1,\n    floor: number = NaN,\n    multiplier: number = DEFAULT_JITTER_MULTIPLIER,\n    weight: number = NaN,\n    current: number = 0\n  ): number[] {\n    const nextCurrent = current + 1;\n    const copy = [...arr];\n\n    if (nextCurrent <= passes) {\n      const jittered: number[] = [];\n      for (const num of copy) {\n        let w = weight;\n        if (!w && !isNaN(w)) {\n          w = (1 + Math.floor(num / 10)) * (Math.random() > 0.5 ? 1 : -1);\n        }\n        let value = num + Math.floor(Math.random() * multiplier * w);\n        if (!isNaN(floor) && value < floor) {\n          value = floor;\n        }\n        jittered.push(value);\n      }\n      return this.jitter(jittered, passes, floor, multiplier, weight, nextCurrent);\n    }\n    return copy;\n  }\n\n  // Trimean (Tukey's trimean: (Q1 + 2*median + Q3) / 4)\n  trimean(): number {\n    const med = this.median();\n    const h = this.hinges();\n    if (h.length < 2) return med.datum;\n    return (h[0].datum + 2 * med.datum + h[1].datum) / 4;\n  }\n\n  // Letter values (depth-based summaries beyond hinges)\n  letterValues(): Array<{ letter: string; depth: number; lower: number; upper: number; mid: number; spread: number }> {\n    this.sorted();\n    const n = this.data.sorted!.length;\n    if (n < 2) return [];\n\n    const letters = ['M', 'F', 'E', 'D', 'C', 'B', 'A', 'Z', 'Y', 'X', 'W', 'V', 'U', 'T', 'S'];\n    const results: Array<{ letter: string; depth: number; lower: number; upper: number; mid: number; spread: number }> = [];\n\n    // M = median\n    const medDepth = (n + 1) / 2;\n    const medValue = this.median().datum;\n    results.push({\n      letter: 'M',\n      depth: medDepth,\n      lower: medValue,\n      upper: medValue,\n      mid: medValue,\n      spread: 0,\n    });\n\n    // Subsequent letter values\n    let depth = medDepth;\n    let letterIdx = 1;\n\n    while (depth > 1 && letterIdx < letters.length) {\n      depth = Math.floor((Math.floor(depth) + 1) / 2);\n      if (depth < 1) break;\n\n      const lowerIdx = Math.ceil(depth) - 1;\n      const upperIdx = n - Math.ceil(depth);\n\n      if (lowerIdx < 0 || upperIdx >= n || lowerIdx >= upperIdx) break;\n\n      const lower = this.data.sorted![lowerIdx];\n      const upper = this.data.sorted![upperIdx];\n      const mid = (lower + upper) / 2;\n      const spread = upper - lower;\n\n      results.push({\n        letter: letters[letterIdx],\n        depth,\n        lower,\n        upper,\n        mid,\n        spread,\n      });\n\n      letterIdx++;\n    }\n\n    return results;\n  }\n\n  // Rough (residuals: original - smooth)\n  rough(): number[] {\n    if (!this.data.rough) {\n      this.smooth();\n    }\n    return this.data.rough || [];\n  }\n\n  // Stem-and-leaf display (text-based visualization)\n  stemLeaf(leafDigits: number = 1): { stems: string[]; leaves: Record<string, string[]>; display: string[] } {\n    this.sorted();\n    const data = this.data.sorted!;\n    if (!data.length) return { stems: [], leaves: {}, display: [] };\n\n    const scale = Math.pow(10, leafDigits);\n    const stems = new Map<number, number[]>();\n\n    for (const val of data) {\n      const stem = Math.floor(val / scale);\n      const leaf = Math.abs(Math.round(val % scale));\n      if (!stems.has(stem)) {\n        stems.set(stem, []);\n      }\n      stems.get(stem)!.push(leaf);\n    }\n\n    const sortedStems = Array.from(stems.keys()).sort((a, b) => a - b);\n    const stemStrings: string[] = [];\n    const leavesRecord: Record<string, string[]> = {};\n    const display: string[] = [];\n\n    for (const stem of sortedStems) {\n      const stemStr = String(stem);\n      stemStrings.push(stemStr);\n      const leaves = stems.get(stem)!.sort((a, b) => a - b).map(String);\n      leavesRecord[stemStr] = leaves;\n      display.push(`${stemStr.padStart(4)} | ${leaves.join(' ')}`);\n    }\n\n    return { stems: stemStrings, leaves: leavesRecord, display };\n  }\n\n  // Mid-summaries (averages of symmetric quantile pairs)\n  midSummaries(): Array<{ depth: number; mid: number; spread: number }> {\n    const lv = this.letterValues();\n    return lv.map(({ depth, mid, spread }) => ({ depth, mid, spread }));\n  }\n\n  // Describe - full summary\n  describe(): SeriesDescription {\n    this.data.description = {\n      original: this.data.original,\n      summary: {\n        median: this.median(),\n        mean: this.mean(),\n        mode: this.mode(),\n        hinges: this.hinges(),\n        adjacent: this.adjacent(),\n        outliers: this.outliers(),\n        outer: this.outer(),\n        outside: this.outside(),\n        inside: this.inside(),\n        extremes: this.extremes(),\n        iqr: this.iqr(),\n        fences: this.fences(),\n      },\n      smooths: {\n        smooth: this.smooth(),\n        hanning: this.hanning(),\n      },\n      transforms: {\n        logs: this.logs(),\n        roots: this.roots(),\n        inverse: this.inverse(),\n      },\n      counts: this.counts(),\n      sorted: this.sorted(),\n      ranked: this.ranked(),\n      binned: this.binned(),\n    };\n    return this.data.description;\n  }\n}\n\n/**\n * Points class for n-dimensional data exploration\n */\nexport class Points {\n  private data: {\n    original: number[][];\n    description?: PointsDescription;\n  };\n  private dimension: number;\n  private count: number;\n\n  constructor(options: PointsOptions | number = {}) {\n    if (typeof options === 'number') {\n      this.count = options;\n      this.dimension = DEFAULT_MAX_RANDOM_DIMENSIONALITY;\n      this.data = {\n        original: randomPoints(this.count, this.dimension),\n      };\n    } else {\n      this.dimension = options.dimensionality ?? 2;\n      this.count = options.count ?? 100;\n      this.data = {\n        original: options.data ?? randomPoints(this.count, this.dimension),\n      };\n    }\n  }\n\n  describe(): PointsDescription {\n    this.data.description = {\n      original: this.data.original,\n    };\n    return this.data.description;\n  }\n}\n\n/**\n * Main Twokeys class - factory for Series and Points\n */\nexport class Twokeys {\n  public smoothed: boolean = false;\n\n  // Constants\n  static readonly DEFAULT_MAX_RANDOM_INTEGER = DEFAULT_MAX_RANDOM_INTEGER;\n  static readonly DEFAULT_MIN_RANDOM_INTEGER = DEFAULT_MIN_RANDOM_INTEGER;\n  static readonly DEFAULT_RANDOM_SERIES_COUNT = DEFAULT_RANDOM_SERIES_COUNT;\n  static readonly DEFAULT_OUTLIER_MULTIPLE = DEFAULT_OUTLIER_MULTIPLE;\n  static readonly DEFAULT_JITTER_MULTIPLIER = DEFAULT_JITTER_MULTIPLIER;\n  static readonly DEFAULT_SPLIT_PASSES = DEFAULT_SPLIT_PASSES;\n  static readonly DEFAULT_MAX_RANDOM_DIMENSIONALITY = DEFAULT_MAX_RANDOM_DIMENSIONALITY;\n\n  // Static factory methods\n  static Series = Series;\n  static Points = Points;\n\n  // Utility methods\n  static randomInteger = randomInteger;\n  static randomSeries = randomSeries;\n  static randomPoint = randomPoint;\n  static randomPoints = randomPoints;\n}\n\n// Default export\nexport default Twokeys;\n"]}